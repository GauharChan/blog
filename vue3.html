<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>gauhar&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1206812165499181"></script>
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="just a blog">
    
    <link rel="preload" href="/blog/assets/css/0.styles.58beb27f.css" as="style"><link rel="preload" href="/blog/assets/js/app.6696418a.js" as="script"><link rel="preload" href="/blog/assets/js/2.dd871ef0.js" as="script"><link rel="preload" href="/blog/assets/js/21.5dd44e89.js" as="script"><link rel="preload" href="/blog/assets/js/6.e3dc3ccf.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.90e44c03.js"><link rel="prefetch" href="/blog/assets/js/11.b6ad5db7.js"><link rel="prefetch" href="/blog/assets/js/12.74d0113b.js"><link rel="prefetch" href="/blog/assets/js/13.1925701c.js"><link rel="prefetch" href="/blog/assets/js/14.8d746f60.js"><link rel="prefetch" href="/blog/assets/js/15.565d712d.js"><link rel="prefetch" href="/blog/assets/js/16.9e4d670c.js"><link rel="prefetch" href="/blog/assets/js/17.107f47e1.js"><link rel="prefetch" href="/blog/assets/js/18.99f3aed6.js"><link rel="prefetch" href="/blog/assets/js/19.4a03c0be.js"><link rel="prefetch" href="/blog/assets/js/20.8259f7a9.js"><link rel="prefetch" href="/blog/assets/js/22.d82b281b.js"><link rel="prefetch" href="/blog/assets/js/23.5deee1b9.js"><link rel="prefetch" href="/blog/assets/js/24.e81376c8.js"><link rel="prefetch" href="/blog/assets/js/25.027d3601.js"><link rel="prefetch" href="/blog/assets/js/26.c7195d9f.js"><link rel="prefetch" href="/blog/assets/js/27.ad4440a0.js"><link rel="prefetch" href="/blog/assets/js/28.89281d09.js"><link rel="prefetch" href="/blog/assets/js/29.b4e8bc55.js"><link rel="prefetch" href="/blog/assets/js/3.03fb4c3b.js"><link rel="prefetch" href="/blog/assets/js/30.35b75104.js"><link rel="prefetch" href="/blog/assets/js/31.159edfd1.js"><link rel="prefetch" href="/blog/assets/js/32.83449d03.js"><link rel="prefetch" href="/blog/assets/js/4.ac0da8c7.js"><link rel="prefetch" href="/blog/assets/js/5.fde13f44.js"><link rel="prefetch" href="/blog/assets/js/7.f3d4cf9a.js"><link rel="prefetch" href="/blog/assets/js/8.72699b13.js"><link rel="prefetch" href="/blog/assets/js/9.5266696d.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.58beb27f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">gauhar's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–ç‰ˆæœ¬åšå®¢" class="dropdown-title"><span class="title">å…¶ä»–ç‰ˆæœ¬åšå®¢</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶ä»–ç‰ˆæœ¬åšå®¢" class="mobile-dropdown-title"><span class="title">å…¶ä»–ç‰ˆæœ¬åšå®¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gauharchan.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vitepressç‰ˆ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gauhar.gitee.io/vuepress_node/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æŸnodeèµ„æº
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gauhar.gitee.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hexoç‰ˆ(ä¸ç»´æŠ¤)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://gitee.com/gauhar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç äº‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/GauharChan/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å…¶ä»–ç‰ˆæœ¬åšå®¢" class="dropdown-title"><span class="title">å…¶ä»–ç‰ˆæœ¬åšå®¢</span> <span class="arrow down"></span></button> <button type="button" aria-label="å…¶ä»–ç‰ˆæœ¬åšå®¢" class="mobile-dropdown-title"><span class="title">å…¶ä»–ç‰ˆæœ¬åšå®¢</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gauharchan.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  vitepressç‰ˆ
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gauhar.gitee.io/vuepress_node/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æŸnodeèµ„æº
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gauhar.gitee.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  hexoç‰ˆ(ä¸ç»´æŠ¤)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://gitee.com/gauhar" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ç äº‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/GauharChan/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/reactç¬”è®°.html" class="sidebar-link">react</a></li><li><a href="/blog/vue3.html" aria-current="page" class="active sidebar-link">vue3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#å¼‚æ­¥ç»„ä»¶" class="sidebar-link">å¼‚æ­¥ç»„ä»¶</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#composition-api" class="sidebar-link">Composition API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#setup" class="sidebar-link">setup</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#ref" class="sidebar-link">ref</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#reactive" class="sidebar-link">reactive</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#watch" class="sidebar-link">watch</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#watcheffect" class="sidebar-link">watchEffect</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#æ–°çš„ç”Ÿå‘½å‘¨æœŸ" class="sidebar-link">æ–°çš„ç”Ÿå‘½å‘¨æœŸ</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#èŠ‚ç‚¹çš„-ref" class="sidebar-link">èŠ‚ç‚¹çš„ ref</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#ç»‘å®šå…¨å±€å˜é‡" class="sidebar-link">ç»‘å®šå…¨å±€å˜é‡</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#treeshaking" class="sidebar-link">TreeShaking</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#reactive-ä»£æ›¿-vuex" class="sidebar-link">reactive ä»£æ›¿ vuex</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#vuex" class="sidebar-link">vuex</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#è·å–storeå¯¹è±¡" class="sidebar-link">è·å–storeå¯¹è±¡</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#é¡µé¢ä¸­ä½¿ç”¨-state-çš„å˜é‡" class="sidebar-link">é¡µé¢ä¸­ä½¿ç”¨ state çš„å˜é‡</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#setup-è¯­æ³•ç³–" class="sidebar-link">setup è¯­æ³•ç³–</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#ts-é…åˆ-defineprops-ä½¿ç”¨" class="sidebar-link">TS é…åˆ defineProps ä½¿ç”¨</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#è°ƒè¯•" class="sidebar-link">è°ƒè¯•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#console" class="sidebar-link">console</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#è·¯ç”±" class="sidebar-link">è·¯ç”±</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#vite-é…ç½®" class="sidebar-link">vite é…ç½®</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#æ–‡æ¡£" class="sidebar-link">æ–‡æ¡£</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#unref" class="sidebar-link">unRef</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#teleport" class="sidebar-link">Teleport</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#emits" class="sidebar-link">emits</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#ç»„ä»¶-v-model" class="sidebar-link">ç»„ä»¶ v-model</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#defineasynccomponent" class="sidebar-link">defineAsyncComponent</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#æŒ‰é”®ä¿®é¥°ç¬¦" class="sidebar-link">æŒ‰é”®ä¿®é¥°ç¬¦</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#è¿‡æ¸¡ç±»å" class="sidebar-link">è¿‡æ¸¡ç±»å</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#css" class="sidebar-link">css</a></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#provide-inject" class="sidebar-link">Provide / Inject</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/vue3.html#computed" class="sidebar-link">computed</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/vue3.html#computed-debugging" class="sidebar-link">Computed Debugging</a></li></ul></li></ul></li><li><a href="/blog/vue3æºç .html" class="sidebar-link">vue3æºç </a></li><li><a href="/blog/antv.html" class="sidebar-link">antv</a></li><li><a href="/blog/typeScript.html" class="sidebar-link">typeScript</a></li><li><a href="/blog/taro.html" class="sidebar-link">taro1.x</a></li><li><a href="/blog/uniapp.html" class="sidebar-link">uniapp</a></li><li><a href="/blog/es6ç¬”è®°.html" class="sidebar-link">es6ç¬”è®°</a></li><li><a href="/blog/é—®é¢˜.html" class="sidebar-link">é—®é¢˜</a></li><li><a href="/blog/jså­¦ä¹ ç¬”è®°.html" class="sidebar-link">jså­¦ä¹ ç¬”è®°</a></li><li><a href="/blog/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/blog/vueç¬”è®°.html" class="sidebar-link">vueç¬”è®°</a></li><li><a href="/blog/å¸¸ç”¨ä»£ç .html" class="sidebar-link">å¸¸ç”¨ä»£ç </a></li><li><a href="/blog/å·¥ä½œå¸¸ç”¨ä»£ç .html" class="sidebar-link">å·¥ä½œå¸¸ç”¨ä»£ç </a></li><li><a href="/blog/å·¥ä½œä¸Šé‡åˆ°çš„å‘.html" class="sidebar-link">å·¥ä½œä¸Šé‡åˆ°çš„å‘</a></li><li><a href="/blog/é‚£äº›å‘.html" class="sidebar-link">é‚£äº›å‘</a></li><li><a href="/blog/æ­£åˆ™è¡¨è¾¾å¼.html" class="sidebar-link">æ­£åˆ™è¡¨è¾¾å¼</a></li><li><a href="/blog/flutter.html" class="sidebar-link">flutter</a></li><li><a href="/blog/jsç¬”è®°.html" class="sidebar-link">jsç¬”è®°</a></li><li><a href="/blog/note.html" class="sidebar-link">note</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="adswrapper"><!----> <div style="display:none;"></div> <ins data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-1206812165499181" data-ad-slot="9205356858" data-ad-test="" data-ad-region="" class="adsbygoogle" style="display:block;"></ins> <!----> <div style="display:none;"> (adsbygoogle = window.adsbygoogle || []).push({}); </div></div> <h2 id="å¼‚æ­¥ç»„ä»¶"><a href="#å¼‚æ­¥ç»„ä»¶" class="header-anchor">#</a> å¼‚æ­¥ç»„ä»¶</h2> <p>ä»¥å‰çš„å†™æ³•</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">asyncPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./NextPage.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç°åœ¨è¦æ”¾åœ¨<code>defineAsyncComponent</code>æ–¹æ³•å†…</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> asyncPage <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./NextPage.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="composition-api"><a href="#composition-api" class="header-anchor">#</a> Composition API</h2> <h3 id="setup"><a href="#setup" class="header-anchor">#</a> setup</h3> <blockquote><p>å…¥å£å‡½æ•°ï¼Œ<code>Composition API</code>åœ¨æ­¤å‡½æ•°ä¸­ä½¿ç”¨</p></blockquote> <ul><li><code>props</code>: ç”¨æ¥æ¥æ”¶ <code>props</code> æ•°æ®</li> <li><code>context</code> ç”¨æ¥å®šä¹‰ä¸Šä¸‹æ–‡, ä¸Šä¸‹æ–‡å¯¹è±¡ä¸­åŒ…å«äº†ä¸€äº›æœ‰ç”¨çš„å±æ€§ï¼Œè¿™äº›å±æ€§åœ¨ <code>vue 2.x</code> ä¸­éœ€è¦é€šè¿‡ <code>this</code> æ‰èƒ½è®¿é—®åˆ°, åœ¨ setup() å‡½æ•°ä¸­æ— æ³•è®¿é—®åˆ° thisï¼Œæ˜¯ä¸ª <code>undefined</code></li> <li>è¿”å›å€¼: <code>return {}</code>, è¿”å›å“åº”å¼æ•°æ®, <code>template</code>æ¨¡ç‰ˆä¸­éœ€è¦ä½¿ç”¨çš„<strong>å˜é‡ã€å‡½æ•°</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context<span class="token punctuation">.</span>attrs
  context<span class="token punctuation">.</span>slots
  context<span class="token punctuation">.</span>parent
  context<span class="token punctuation">.</span>root
  context<span class="token punctuation">.</span>emit
  context<span class="token punctuation">.</span>refs

  <span class="token keyword">return</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ref"><a href="#ref" class="header-anchor">#</a> ref</h3> <blockquote><p>åˆ›å»ºä¸€ä¸ªå“åº”çš„æ•°æ®å¯¹è±¡ï¼Œé€šè¿‡<code>value</code>å±æ€§è¿›è¡Œ<code>set</code>å’Œ<code>get</code>å€¼ã€‚å½“ç„¶ï¼Œæ¨¡æ¿ç›´æ¥è°ƒç”¨å³å¯</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClick<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;gauhar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;gauharchan&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">,</span>
      handleClick<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="reactive"><a href="#reactive" class="header-anchor">#</a> reactive</h3> <blockquote><p>è¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ›å»ºè¿”å›ä¸€ä¸ªå“åº”å¼å¯¹è±¡ã€‚</p> <p>é€šå¸¸æ­é…<code>toRefs</code>å‡½æ•°è½¬æ¢ä¸ºä¸€ä¸ªä¸ª<code>ref</code>å“åº”å¼æ•°æ®ï¼Œåœ¨è¿”å›å‡ºå»ï¼Œåœ¨æ¨¡æ¿ä¸­æ­£å¸¸ä½¿ç”¨ã€‚å¦‚æœç›´æ¥è¿”å›<code>state</code>ï¼Œåœ¨æ¨¡æ¿ä¸­<code>state.xxx</code>è°ƒç”¨</p> <p>ä¸å¯ç›´æ¥è§£æ„å±æ€§ä½¿ç”¨ï¼Œå¦åˆ™ä¼šä¸¢å¤±å“åº”å¼ã€‚å¦‚éœ€è§£æ„ï¼Œè¯·ä½¿ç”¨<code>toRefs</code>è½¬åŒ–åå†è§£æ„</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">decs</span><span class="token operator">:</span> <span class="token string">&quot;ä¹¦æœ¬ä¸­æœ‰å†œåœºï¼ŒæŠ¬å¤´åªå¾—æ“åœº&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> state<span class="token punctuation">;</span> <span class="token comment">// ä¸¢å¤±å“åº”æ€§ğŸ˜­</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜ æ­¤æ—¶countæ˜¯ä¸€ä¸ªrefï¼Œæ‰€ä»¥åé¢ä½¿ç”¨éœ€è¦count.value</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h3> <div class="custom-block danger"><p class="custom-block-title">æ³¨æ„</p> <p><code>watch()</code> å’Œ <code>watchEffect()</code> åœ¨ DOM æŒ‚è½½æˆ–æ›´æ–°<em>ä¹‹å‰</em>è¿è¡Œå‰¯ä½œç”¨(å›è°ƒå‡½æ•°)ï¼Œæ‰€ä»¥å½“ä¾¦å¬å™¨è¿è¡Œæ—¶ï¼Œæ¨¡æ¿å¼•ç”¨è¿˜æœªè¢«æ›´æ–°ã€‚</p></div> <p>ç›‘å¬<code>reactive</code>å¯¹è±¡ä¸­çš„æŸä¸€é¡¹ï¼Œ<code>watch</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ç”¨å‡½æ•°è¿”å›é‚£ä¸€é¡¹ã€‚æˆ–è€…ä½¿ç”¨<code>toRefs</code>è½¬æ¢ä¸º<code>ref</code>å¯¹è±¡</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ä½¿ç”¨å‡½æ•°è¿”å›</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> onInvalidate</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> <span class="token string">&quot;watch&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ä½¿ç”¨toRefs</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> <span class="token string">&quot;watchBytoRefs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;gauhar&quot;</span><span class="token punctuation">;</span>
</code></pre></div><p>æ‰€ä»¥å¦‚æœè¦ç›‘å¬çš„æ˜¯<code>ref</code>å¯¹è±¡ï¼Œç›´æ¥å†™å³å¯</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">watch</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> onInvalidate</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> <span class="token string">&quot;watch1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123 0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
num<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>æ³¨æ„<code>watchCallback</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯<code>onInvalidate</code>ï¼Œ<a href="/blog/vue3.html#oninvalidate">è¯¦æƒ…è¯·çœ‹</a></p></div> <h4 id="åŒæ—¶ç›‘å¬å¤šä¸ª"><a href="#åŒæ—¶ç›‘å¬å¤šä¸ª" class="header-anchor">#</a> åŒæ—¶ç›‘å¬å¤šä¸ª</h4> <blockquote><p>æ³¨æ„ï¼Œå›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ•°ç»„æ˜¯æ‰€ç›‘å¬å¯¹è±¡çš„æ–°å€¼çš„æ•°ç»„ï¼ˆ<code>newNum</code>, <code>newCount</code>ï¼‰ã€‚ç¬¬äºŒä¸ªæ•°ç»„æ˜¯æ—§å€¼çš„æ•°ç»„</p> <p>ç›‘å¬å¤šä¸ªæ—¶ï¼Œåªè¦æœ‰ä¸€ä¸ªæ›´æ–°å°±ä¼šè§¦å‘ï¼Œå¦‚ä¸‹é¢çš„ num</p> <p>æ³¨æ„å¤šä¸ªåŒæ­¥æ›´æ”¹åªä¼šè§¦å‘ä¸€æ¬¡ä¾¦å¬å™¨ã€‚</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">count</span><span class="token operator">:</span> <span class="token number">456</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>num<span class="token punctuation">,</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>newNum<span class="token punctuation">,</span> newCount<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>oldNum<span class="token punctuation">,</span> oldCount<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newNum<span class="token punctuation">,</span> oldNum<span class="token punctuation">,</span> <span class="token string">&quot;watchNum&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newCount<span class="token punctuation">,</span> oldCount<span class="token punctuation">,</span> <span class="token string">&quot;watchCount&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
num<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
</code></pre></div><p>åœæ­¢ç›‘å¬</p> <blockquote><p>æ‰§è¡Œ<code>watch</code>è¿”å›çš„å‡½æ•°å³å¯</p></blockquote> <h4 id="ç›‘å¬-props-çš„å˜åŒ–"><a href="#ç›‘å¬-props-çš„å˜åŒ–" class="header-anchor">#</a> ç›‘å¬ props çš„å˜åŒ–</h4> <blockquote><p>å¯¹äºç»„ä»¶çš„<code>props</code>å¯¹è±¡ï¼Œä»–æ˜¯å“åº”å¼çš„ï¼›<code>watch</code>ç›‘å¬æ•´ä¸ª<code>props</code>çš„æ”¹å˜æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ç›‘å¬<code>props</code>çš„å±æ€§ç›´æ¥<code>watch</code>æ˜¯ä¸å¯è¡Œçš„</p></blockquote> <p><font color="red"><strong>â é”™è¯¯ç¤ºèŒƒ</strong></font></p> <p>ç›´æ¥ props. æŸä¸ªå±æ€§ï¼Œæˆ–è€…è¯´ç›´æ¥ä» props ä¸­è§£æ„å‡ºæ¥ç›‘å¬æ˜¯ä¸è¡Œçš„ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">watch</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>dataList<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;newVal&quot;</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>âœ…<strong>æ­£ç¡®å§¿åŠ¿</strong></p> <p>1.ä½¿ç”¨ computed è¿”å›æŒ‡å®šå±æ€§ 2.ä½¿ç”¨ toRefs è½¬æ¢æ•´ä¸ª props</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1.ä½¿ç”¨computedè¿”å›æŒ‡å®šå±æ€§</span>
<span class="token keyword">const</span> dataList <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">watch</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;newVal&quot;</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2.ä½¿ç”¨toRefsè½¬æ¢æ•´ä¸ªprops</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> dataList <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">watch</span><span class="token punctuation">(</span>dataList<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;newVal&quot;</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="watcheffect"><a href="#watcheffect" class="header-anchor">#</a> watchEffect</h3> <blockquote><p><font color="red"><code>watch()</code> å’Œ <code>watchEffect()</code> åœ¨ DOM æŒ‚è½½æˆ–æ›´æ–°<em>ä¹‹å‰</em>è¿è¡Œå‰¯ä½œç”¨(å›è°ƒå‡½æ•°)ï¼Œæ‰€ä»¥å½“ä¾¦å¬å™¨è¿è¡Œæ—¶ï¼Œæ¨¡æ¿å¼•ç”¨è¿˜æœªè¢«æ›´æ–°ã€‚</font></p></blockquote> <p>ä¸<code>watch</code>ä¸åŒçš„æ˜¯</p> <ul><li>ä¸éœ€è¦æŒ‡å®šç›‘å¬çš„å˜é‡ï¼Œåœ¨<code>watchEffect</code>çš„å›è°ƒä¸­ä½¿ç”¨äº†å“ªäº›å˜é‡å°±ä¼šç›‘å¬å“ªäº›å˜é‡</li> <li>ä¹Ÿæ­£å› ä¸ºç¬¬ä¸€ç‚¹ï¼Œåœ¨<strong>åˆå§‹åŒ–çš„æ—¶å€™ä¼šæ‰§è¡Œä¸€æ¬¡</strong>æ”¶é›†ä¾èµ–ï¼ˆå›è°ƒä¸­ä½¿ç”¨çš„å˜é‡ï¼‰</li> <li>æ‹¿ä¸åˆ°æ–°æ—§å€¼</li></ul> <h4 id="ç›‘å¬çš„ä¸œè¥¿ä¸€å®šæ˜¯è¦å…·ä½“åˆ°å€¼"><a href="#ç›‘å¬çš„ä¸œè¥¿ä¸€å®šæ˜¯è¦å…·ä½“åˆ°å€¼" class="header-anchor">#</a> <font color="red">ç›‘å¬çš„ä¸œè¥¿ä¸€å®šæ˜¯è¦å…·ä½“åˆ°å€¼</font></h4> <blockquote><p>å¦åˆ™åœ¨é¡µé¢ç¬¬ä¸€æ¬¡æ”¶é›†ä¾èµ–çš„æ—¶å€™ä¼šæ‰§è¡Œã€‚åé¢æ•°æ®æ”¹å˜åä¸å“åº”ã€‚</p> <p>å›è°ƒä¸­åªç›‘å¬ ref æˆ– reactive ä¸­çš„å±æ€§(ref ä¸åŒ…å« ref.value)</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> computed<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> watchEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// date: {startTime: '2020-01'}</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> date<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  ğŸ™x</span>
  <span class="token comment">// å…·ä½“åˆ°é‡Œé¢çš„startTime</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span>value<span class="token punctuation">.</span>startTime<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜âˆš</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ref çš„ä¾‹å­</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token literal-property property">obj</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">aa</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">sum</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;obj.aa&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ™x</span>
  <span class="token comment">// å…·ä½“åˆ°é‡Œé¢çš„aa</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;obj.aa&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>value<span class="token punctuation">.</span>aa<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜âˆš</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="oninvalidate"><a href="#oninvalidate" class="header-anchor">#</a> onInvalidate()</h4> <p>è¿‡æœŸé’©å­å‡½æ•°ï¼Œä»–çš„æ‰§è¡Œæ—¶æœºæ˜¯**â€œåœ¨ watch å†…éƒ¨æ¯æ¬¡æ£€æµ‹åˆ°å˜æ›´åï¼Œåœ¨å‰¯ä½œç”¨å‡½æ•°é‡æ–°æ‰§è¡Œä¹‹å‰â€**</p> <p><code>onInvalidate(fn)</code>ä¼ å…¥çš„å›è°ƒä¼šåœ¨ <code>watchEffect</code> é‡æ–°è¿è¡Œæˆ–è€… <code>watchEffect</code> åœæ­¢çš„æ—¶å€™æ‰§è¡Œ</p> <p>å¸¸ç”¨äºåœ¨<code>WatchCallback</code>ä¸­æ§åˆ¶å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚åœ¨<code>callback</code>ä¸­å‘èµ·è¯·æ±‚ï¼Œè§¦å‘äº†ä¸¤æ¬¡<code>watch</code>ï¼Œä¹Ÿå°±æ˜¯è§¦å‘äº†ä¸¤æ¬¡è¯·æ±‚ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªå…³å¿ƒæœ€åä¸€æ¬¡çš„ç»“æœï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­å–æ¶ˆè¯·æ±‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">onInvalidate</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// å¼‚æ­¥apiè°ƒç”¨ï¼Œè¿”å›ä¸€ä¸ªæ“ä½œå¯¹è±¡</span>
  <span class="token keyword">const</span> apiCall <span class="token operator">=</span> <span class="token function">someAsyncMethod</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>userID<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">onInvalidate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å–æ¶ˆå¼‚æ­¥apiçš„è°ƒç”¨ã€‚</span>
    apiCall<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢æåˆ°çš„æ¨¡æ¿å¼•ç”¨ï¼Œå¦‚æœæƒ³ä¿®æ”¹è¿™ä¸ªé»˜è®¤çš„è¡Œä¸ºï¼Œå¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°æ›´æ”¹</p> <ul><li>flush
<ul><li>'pre': é»˜è®¤å€¼ï¼Œç»„ä»¶æ›´æ–°<strong>å‰</strong>è§¦å‘å‰¯ä½œç”¨</li> <li>'post': ç»„ä»¶æ›´æ–°<strong>å</strong>è§¦å‘å‰¯ä½œç”¨</li> <li>'sync': ç»„ä»¶æ›´æ–°<strong>åŒæ­¥</strong>è§¦å‘å‰¯ä½œç”¨</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// åœ¨ç»„ä»¶æ›´æ–°åè§¦å‘ï¼Œè¿™æ ·ä½ å°±å¯ä»¥è®¿é—®æ›´æ–°çš„ DOMã€‚</span>
<span class="token comment">// æ³¨æ„ï¼šè¿™ä¹Ÿå°†æ¨è¿Ÿå‰¯ä½œç”¨çš„åˆå§‹è¿è¡Œï¼Œç›´åˆ°ç»„ä»¶çš„é¦–æ¬¡æ¸²æŸ“å®Œæˆã€‚</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/* ... */</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">flush</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-2-æ–°å¢"><a href="#_3-2-æ–°å¢" class="header-anchor">#</a> 3.2 æ–°å¢</h4> <p><code>watchPostEffect</code>å’Œ<code>watchSyncEffect</code>åˆ«åä»£æ›¿<code>flush</code>é€‰é¡¹ä¹Ÿå¯ç”¨äºä½¿ä»£ç æ„å›¾æ›´åŠ æ˜æ˜¾ã€‚</p> <h3 id="æ–°çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#æ–°çš„ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> æ–°çš„ç”Ÿå‘½å‘¨æœŸ</h3> <blockquote><p>åœ¨<code>setup</code>å‡½æ•°ä¸­ä½¿ç”¨</p> <p>vue3 å–æ¶ˆäº†<code>beforeCreate</code>å’Œ<code>created</code>ï¼Œç”±<code>setup</code>å‡½æ•°ä»£æ›¿</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> set <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;lodash&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  defineComponent<span class="token punctuation">,</span>
  onBeforeMount<span class="token punctuation">,</span>
  onBeforeUnmount<span class="token punctuation">,</span>
  onBeforeUpdate<span class="token punctuation">,</span>
  onErrorCaptured<span class="token punctuation">,</span>
  onMounted<span class="token punctuation">,</span>
  onUnmounted<span class="token punctuation">,</span>
  onUpdated<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">onBeforeMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;beformounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;mounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">onBeforeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;beforupdated!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onUpdated</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;updated!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;beforunmounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;unmounted!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">onErrorCaptured</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;errorCaptured!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="èŠ‚ç‚¹çš„-ref"><a href="#èŠ‚ç‚¹çš„-ref" class="header-anchor">#</a> èŠ‚ç‚¹çš„ ref</h3> <blockquote><p><code>this.$ref.xxx</code>è¿™ä¸ªåœ¨ vue2 ä¹Ÿæ˜¯å¾ˆç»å¸¸ä½¿ç”¨</p> <p><font color="red"><code>watch()</code> å’Œ <code>watchEffect()</code> åœ¨ DOM æŒ‚è½½æˆ–æ›´æ–°<em>ä¹‹å‰</em>è¿è¡Œå‰¯ä½œç”¨(å›è°ƒå‡½æ•°)ï¼Œæ‰€ä»¥å½“ä¾¦å¬å™¨è¿è¡Œæ—¶ï¼Œæ¨¡æ¿å¼•ç”¨è¿˜æœªè¢«æ›´æ–°ã€‚</font></p></blockquote> <ol><li>åˆ›å»ºä¸€ä¸ª<code>ref</code>å¯¹è±¡ï¼Œåˆå§‹åŒ–ä¸º<code>null</code></li> <li>return å‡ºå»</li> <li>åœ¨<code>template</code>èŠ‚ç‚¹ä¸­ç»‘å®š</li> <li>é€šè¿‡<code>.value</code>ä½¿ç”¨</li></ol> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span>
    <span class="token attr-name">controls</span>
    <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>audio<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://gauhar.top/music/static/media/%E6%9E%97%E4%BF%8A%E6%9D%B0-%E9%9B%AA%E8%90%BD%E4%B8%8B%E7%9A%84%E5%A3%B0%E9%9F%B3.ff6502e.mp3<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">loop</span>
  <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> onMounted<span class="token punctuation">,</span> reactive<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> audio <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>audio<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŸç”Ÿdom</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      audio<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="ç»‘å®šå…¨å±€å˜é‡"><a href="#ç»‘å®šå…¨å±€å˜é‡" class="header-anchor">#</a> ç»‘å®šå…¨å±€å˜é‡</h3> <blockquote><p>åœ¨<code>main.js</code>ä¸­ï¼Œé€šè¿‡å®ä¾‹çš„<code>config.globalProperties</code>ç»‘å®šå…¨å±€å˜é‡</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./index.css&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$message <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åœ¨é¡µé¢ä¸­é€šè¿‡<code>config.globalProperties</code>çš„<code>ctx</code>è·å–</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">ctx</span><span class="token operator">:</span> that <span class="token punctuation">}</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>$message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</code></pre></div><p>ä½†æ˜¯ï¼Œ<strong>åœ¨ setup ä¸­ä¸å¯ä»¥è°ƒç”¨ getCurrentInstance().ctx æ¥è·å–<font color="red">ç»„ä»¶å†…éƒ¨æ•°æ®</font>ï¼Œå› ä¸ºåœ¨ prod ä¼šè¢«å¹²æ‰</strong></p> <p><font color="blue">æ¨èä½¿ç”¨<code>proxy</code>è·å–ï¼Œæ— è®ºå¼€å‘è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒéƒ½å¯ä»¥è·å–åˆ°</font></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token literal-property property">that</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?.</span>proxy<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>that<span class="token punctuation">.</span>$message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123</span>
</code></pre></div><h2 id="treeshaking"><a href="#treeshaking" class="header-anchor">#</a> TreeShaking</h2> <blockquote><p>æ‘‡æ ‘ä¼˜åŒ–ã€‚æ˜¯é€šè¿‡ç¼–è¯‘å™¨**(<code>webpack</code>ç­‰æ‰“åŒ…å·¥å…·)**è¿›è¡Œçš„ï¼ŒæŠŠæ²¡æœ‰ç”¨åˆ°çš„ä¸œè¥¿å‰”é™¤æ‰ã€‚ä¾èµ–<code>es6</code>çš„æ¨¡å—åŒ–çš„è¯­æ³•ï¼Œå°†æ— ç”¨çš„ä»£ç (<code>dead-code</code>)è¿›è¡Œå‰”é™¤!</p> <p>ä½¿å¾—æœ€åæ‰“å‡ºæ¥çš„åŒ…ä½“ç§¯æ›´å°</p></blockquote> <h2 id="reactive-ä»£æ›¿-vuex"><a href="#reactive-ä»£æ›¿-vuex" class="header-anchor">#</a> reactive ä»£æ›¿ vuex</h2> <blockquote><p>å¾ˆå¤šæ—¶å€™åªæ˜¯ä¸ºäº†ç»„ä»¶ä¹‹é—´é€šä¿¡ã€æœ‰ä¸ªå…¨å±€çš„å“åº”æ•°æ®å¯ä»¥è·å–ã€‚éƒ½ç”¨ vuexï¼Œå°±ä¼šæ˜¾å¾—æœ‰ç‚¹<strong>å¤§æå°ç”¨</strong>çš„æ„æ€</p></blockquote> <p>å’Œ<code>vuex</code>ä¸€æ ·ï¼Œ<code>state</code>ä¸­å®šä¹‰å˜é‡ã€‚<code>mutation</code>å®šä¹‰é€»è¾‘æ–¹æ³•ï¼Œé€šè¿‡<code>mutation</code>çš„æ–¹æ³•å»æ”¹å˜<code>state</code>ä¸­çš„å€¼</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// store/state.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;gauhar&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// store/mutation.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setName</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something</span>
    state<span class="token punctuation">.</span>name <span class="token operator">=</span> value <span class="token operator">+</span> <span class="token string">&quot;commit&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>store/index.js</p> <ul><li>é€šè¿‡<code>reactive</code>å°†<code>state</code>è½¬ä¸ºå“åº”å¼æ•°æ®ï¼Œæ‰€ä»¥æ›´æ”¹<code>state</code>ä¸­çš„å˜é‡ä¹‹åï¼Œé¡µé¢ä¸­å°±å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„å€¼</li> <li>å¯¹å¤–æŠ›å‡ºçš„<code>state</code>ä½¿ç”¨<code>readonly</code>åŒ…ä½ï¼Œé˜²æ­¢ç›´æ¥ä¿®æ”¹<code>state</code>çš„æ•°æ®ã€‚æ¢è€Œè¨€ä¹‹ï¼Œåªèƒ½é€šè¿‡<code>mutation</code>çš„æ–¹æ³•å»æ›´æ”¹å˜é‡çš„å€¼</li> <li><code>commit</code>æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯<code>mutation.js</code> ä¸­çš„å‡½æ•°åç¬¬äºŒä¸ªæ˜¯æ–°çš„å€¼</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">&quot;./state&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> mutation <span class="token keyword">from</span> <span class="token string">&quot;./mutation&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> readonly<span class="token punctuation">,</span> reactive <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> reactiveData <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">commit</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  mutation<span class="token punctuation">[</span>fn<span class="token punctuation">]</span><span class="token punctuation">(</span>reactiveData<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æŠŠå¯æ›´æ”¹çš„å“åº”æ•°æ®ç»™mutation</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span>reactiveData<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>main.js</p> <ul><li>ä½¿ç”¨<code>provide</code>å¾€åä»£ç»„ä»¶æ¨</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> state<span class="token punctuation">,</span> commit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">&quot;./index.css&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;commit&quot;</span><span class="token punctuation">,</span> commit<span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åä»£ä»»æ„ç»„ä»¶é€šè¿‡<code>inject</code>è°ƒç”¨</p> <ul><li><code>let storeData: any = inject('state')</code> get</li> <li><code>let commit: any = inject('commit')</code> set</li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleLogText<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ isRefText }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> unref<span class="token punctuation">,</span> ref<span class="token punctuation">,</span> Ref<span class="token punctuation">,</span> inject<span class="token punctuation">,</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token literal-property property">storeData</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&quot;state&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token literal-property property">commit</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&quot;commit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token literal-property property">isRefText</span><span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">&quot;click me&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">handleLogText</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apiComponent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>storeData<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">&quot;apiComponent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      isRefText<span class="token punctuation">,</span>
      handleLogText<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="vuex"><a href="#vuex" class="header-anchor">#</a> vuex</h2> <h3 id="è·å–storeå¯¹è±¡"><a href="#è·å–storeå¯¹è±¡" class="header-anchor">#</a> è·å–<code>store</code>å¯¹è±¡</h3> <ul><li>option api è¿˜æ˜¯ä¸€æ ·å¯ä»¥é€šè¿‡<code>this.$store</code></li> <li>composition apiï¼Œé€šè¿‡<code>const that = getCurrentInstance()?.proxy</code>æ‹¿åˆ°å®ä¾‹ï¼Œ<code>that.$store</code>è®¿é—®</li> <li>å†åˆ™å°±æ˜¯é€šè¿‡<code>useStore</code>è·å–ã€‚<code>const store = useStore()</code>ã€‚<code>store.state.....</code>ï¼Œ<code>store.commit()....</code></li></ul> <h3 id="é¡µé¢ä¸­ä½¿ç”¨-state-çš„å˜é‡"><a href="#é¡µé¢ä¸­ä½¿ç”¨-state-çš„å˜é‡" class="header-anchor">#</a> é¡µé¢ä¸­ä½¿ç”¨ state çš„å˜é‡</h3> <blockquote><p>é€šè¿‡ computed è¿”å›ï¼Œå¦åˆ™å‡ºç°ä¸å“åº”çš„æƒ…å†µ</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    {{ date.startTime }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="setup-è¯­æ³•ç³–"><a href="#setup-è¯­æ³•ç³–" class="header-anchor">#</a> setup è¯­æ³•ç³–</h2> <blockquote><p>ç›´æ¥å®šä¹‰å˜é‡ï¼Œæ¨¡æ¿ä½¿ç”¨å³å¯</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;gauhar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä»<code>vue</code>ä¸­è§£æ„å‡º<code>defineEmit</code>, <code>defineProps</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token literal-property property">props</span><span class="token operator">:</span> Iprop <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">filterData</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">form</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>form<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ•°ç»„ä¸­çš„å€¼å°±æ˜¯è‡ªå®šä¹‰äº‹ä»¶å</span>
<span class="token keyword">const</span> emit <span class="token operator">=</span> <span class="token function">defineEmit</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;confirm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;reset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;search&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ts-é…åˆ-defineprops-ä½¿ç”¨"><a href="#ts-é…åˆ-defineprops-ä½¿ç”¨" class="header-anchor">#</a> TS é…åˆ defineProps ä½¿ç”¨</h3> <blockquote><p>åœ¨<code>ts</code>ä¸­å£°æ˜<code>props</code>ä¸»è¦æ¶‰åŠåˆ°çš„é—®é¢˜å°±æ˜¯ç±»å‹å£°æ˜ã€‚</p></blockquote> <p>åŸå§‹è¯­æ³•ä¸­ï¼Œtype çš„ç±»å‹é€‰é¡¹æ˜¯ js çš„ç±»å‹ï¼Œæ¯”å¦‚ï¼š<code>String</code>ã€<code>Object</code>ã€‚åœ¨ ts çš„ä½¿ç”¨ä¸­å¹¶ä¸æ»¡è¶³ã€‚ä¸¾ä¸ª ğŸŒ°ï¼Œå®šä¹‰ä¸€ä¸ª<code>Object</code>ç±»å‹ï¼ŒåŒæ—¶æŒ‡å®šé‡Œé¢çš„å±æ€§çš„ç±»å‹ã€‚æˆ–è®¸ä¼šä½¿ç”¨<strong>ç±»å‹æ–­è¨€</strong></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">IFilter</span> <span class="token punctuation">{</span>
  a<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> props<span class="token operator">:</span> Iprop <span class="token operator">=</span> <span class="token function">defineProps</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  filterData<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Object <span class="token keyword">as</span> IFilter<span class="token punctuation">,</span>
    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å®é™…ä¸Š<code>vue3</code>ä¹Ÿæ˜¯æ¨å‡ºäº†é’ˆå¯¹<code>ts</code>çš„<code>api</code></p> <h4 id="ä½¿ç”¨æ³›å‹å£°æ˜"><a href="#ä½¿ç”¨æ³›å‹å£°æ˜" class="header-anchor">#</a> ä½¿ç”¨æ³›å‹å£°æ˜</h4> <blockquote><p>å•çº¯è¿™ä¹ˆå†™æœ‰ä¸ªç¼ºç‚¹ï¼Œä¸èƒ½å£°æ˜é»˜è®¤å€¼</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> props1 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>
  filterData<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>å¦‚æœæƒ³æŒ‡å®šé»˜è®¤å€¼ï¼Œé‚£ä¹ˆå°±é€šè¿‡<code>withDefaults</code>ç¼–è¯‘å™¨å®é…åˆä½¿ç”¨</strong></p> <blockquote><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å®šä¹‰<code>props</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é»˜è®¤å€¼</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  msg<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  labels<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token function">withDefaults</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span>Props<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  msg<span class="token operator">:</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">labels</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="header-anchor">#</a> è°ƒè¯•</h2> <h3 id="console"><a href="#console" class="header-anchor">#</a> console</h3> <blockquote><p>å…¶å®<code>vue3</code>å†…éƒ¨å®ç°äº†ä¸€ä¸ª<code>initCustomFormatter</code> è®©æˆ‘ä»¬åœ¨å¼€å‘æ¨¡å¼ä¸‹æ›´åŠ ç›´è§‚ç¾åŒ–çš„å±•ç¤ºæˆ‘ä»¬æ‰“å°çš„ä¸œè¥¿</p></blockquote> <p>æ¯”å¦‚æ‰“å°ä¸€ä¸ª<code>ref</code>å¯¹è±¡</p> <p><strong>æœªå¼€å¯åŠŸèƒ½å‰</strong></p> <p><img src="https://raw.githubusercontent.com/GauharChan/Picture-bed/main/img/image-20221107164615074.png" alt="image-20221107164615074"></p> <p>åƒæˆ‘è¿™ä¸ªå¼ºè¿«ç—‡ï¼Œæˆ‘æ˜¯ä¸€å®šä¼šæŠŠé‚£ä¸ªæœªå±•å¼€çš„ value ç‚¹ä¸€ä¸‹çš„ ğŸ˜„</p> <p><strong>å¼€å¯å</strong></p> <p><img src="https://raw.githubusercontent.com/GauharChan/Picture-bed/main/img/image-20221107164441262.png" alt="image-20221107164441262"></p> <p>éå¸¸ç›´è§‚ï¼ŒçŸ¥é“æ˜¯ä¸€ä¸ª refï¼Œç„¶åå€¼æ˜¯ 1</p> <p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ª<code>ref</code>çš„<code>value</code>ï¼Œè€Œä¸å…³å¿ƒä»–èº«ä¸Šçš„ä¸€äº›å…¶ä»–æ ‡è¯†ï¼Œæ¯”å¦‚ä¸Šé¢çš„<code>__v_isRef ã€__v_isShallow</code>ReactiveFlagsï¼›è¿™ä¸¤ä¸ªæ ‡è¯†åˆ†åˆ«æ˜¯</p> <ul><li>æ˜¯å¦ä¸º<code>ref</code>å¯¹è±¡</li> <li>æ˜¯å¦ä¸ºæµ…å±‚ä»£ç†</li></ul> <p><code>_rawValue</code>: åŸå§‹æ•°æ®</p> <h4 id="å¼€å¯ç¾åŒ–æ–¹æ³•"><a href="#å¼€å¯ç¾åŒ–æ–¹æ³•" class="header-anchor">#</a> å¼€å¯ç¾åŒ–æ–¹æ³•</h4> <blockquote><p>æ‘˜å½•æ¥è‡ª Vue.js è®¾è®¡ä¸å®ç° éœæ˜¥é˜³ï¼ˆHcySunYangï¼‰</p></blockquote> <p>â€œä»¥ Chrome ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€ DevTools çš„è®¾ç½®ï¼Œç„¶åå‹¾é€‰â€œConsoleâ€â†’â€œEnable custom formattersâ€é€‰é¡¹â€</p> <p><img src="https://raw.githubusercontent.com/GauharChan/Picture-bed/main/img/image-20221107170044242.png" alt="image-20221107170044242"></p> <p>ç„¶ååˆ·æ–°å³å¯ä½¿ç”¨ ğŸ˜</p> <h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="header-anchor">#</a> è·¯ç”±</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute<span class="token punctuation">,</span> useRouter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue-router&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç›‘å¬å®Œæ•´çš„è·¯ç”±ï¼ŒåŒ…æ‹¬hashã€query</span>
<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">.</span>fullPath<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">newVal<span class="token punctuation">,</span> prevVal</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    noBar<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/error&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="vite-é…ç½®"><a href="#vite-é…ç½®" class="header-anchor">#</a> vite é…ç½®</h2> <blockquote><p>é…ç½®åˆ«åçš„æ—¶å€™ï¼Œæ³¨æ„ä¸€ä¸‹ï¼Œæ˜¯<code>/@</code></p> <p>å˜é‡çš„å‘½åå’Œ<code>vue/cli</code>ä¸åŒï¼Œä»¥<code>VITE</code>å¼€å¤´<code>VITE_ENUMS</code></p> <p>ä½¿ç”¨çš„æ¡†æ¶ã€æ’ä»¶å¿…é¡»åœ¨<code>optimizeDeps</code>çš„<code>include</code>ä¸­å£°æ˜</p></blockquote> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vite&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">&quot;@vitejs/plugin-vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;path&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Enums <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;./src/enums/index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_ENUMS</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>Enums<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  alias<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;/@&quot;</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimizeDeps<span class="token operator">:</span> <span class="token punctuation">{</span>
    include<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;js-md5&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;moment&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;ant-design-vue/es/locale/zh_CN&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;@ant-design/icons-vue&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="æ–‡æ¡£"><a href="#æ–‡æ¡£" class="header-anchor">#</a> æ–‡æ¡£</h2> <h3 id="unref"><a href="#unref" class="header-anchor">#</a> unRef</h3> <blockquote><p>è¯­æ³•ç³–ï¼Œå¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯<code>ref</code>å¯¹è±¡ï¼Œå°±è¿”å›<code>å‚æ•°.value</code>ï¼Œå¦åˆ™è¿”å›æœ¬èº«ã€‚</p> <p><code>val = isRef(val) ? val.value: val</code></p></blockquote> <p>è°ƒç”¨<code>getText</code>æ–¹æ³•ï¼Œæ— è®ºæ˜¯æ™®é€šçš„å˜é‡è¿˜æ˜¯å“åº”å¼æ•°æ®ï¼Œéƒ½å¯ä»¥æ­£ç¡®çš„å¾—åˆ°æ–‡æœ¬</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">function</span> <span class="token function">getText</span><span class="token punctuation">(</span>val<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> Ref<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">unref</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="teleport"><a href="#teleport" class="header-anchor">#</a> Teleport</h3> <blockquote><p>å°†å­å…ƒç´ æ¸²æŸ“åˆ°æŒ‡å®šçš„çˆ¶å…ƒç´ ï¼Œå¸¸ç”¨çš„æ˜¯ä¸€ä¸ªç»„ä»¶è°ƒç”¨æ‰“å¼€<code>modalå¼¹çª—</code>ï¼Œç„¶åè®©è¿™ä¸ª<code>modal</code>æ¸²æŸ“åœ¨<code>body</code>ä¸‹ï¼Œè€Œä¸æ˜¯ç»„ä»¶ä¸‹</p></blockquote> <p>ä¸‹é¢çš„<code>modal</code>æœ¬æ¥æ˜¯åœ¨<code>modal-box</code>é‡Œé¢çš„ï¼Œ<code>teleport</code>å°†ä»–ä¼ é€åˆ°<code>body</code></p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleOpen('.modal-box')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>ç»„ä»¶é‡Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleOpen('body')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>body<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>teleport</span> <span class="token attr-name">:to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>dom<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modalOpen<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
          è¿™æ˜¯ä¸€ä¸ªæ¨¡æ€çª—å£! æˆ‘çš„çˆ¶å…ƒç´ æ˜¯&quot;body&quot;ï¼
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modalOpen = false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Close<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>teleport</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> reactive<span class="token punctuation">,</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">modalOpen</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">dom</span><span class="token operator">:</span> <span class="token string">&quot;body&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleOpen</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dom</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>dom <span class="token operator">=</span> dom<span class="token punctuation">;</span>
      state<span class="token punctuation">.</span>modalOpen <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token function">toRefs</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span>
      handleOpen<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.modal</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.modal div</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.modal-box</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #000<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="emits"><a href="#emits" class="header-anchor">#</a> emits</h3> <blockquote><p>å­ç»„ä»¶ä¸­<code>emit</code>è§¦å‘çˆ¶ç»„ä»¶çš„å‡½æ•°çš„è‡ªå®šä¹‰äº‹ä»¶åï¼Œéœ€è¦åœ¨<code>emits</code>é€‰é¡¹ä¸­å£°æ˜</p></blockquote> <p>**å¦‚æœæ²¡æœ‰åœ¨<code>emits</code>å£°æ˜ï¼Œåˆ™ç›‘å¬çš„äº‹ä»¶æŒ‚è½½åœ¨ç»„ä»¶çš„æ ¹èŠ‚ç‚¹ä¸Šã€‚**è¿™ä¹Ÿæ˜¯å»é™¤<code>.native</code>ä¿®é¥°ç¬¦çš„åŸå› </p> <p>å­ç»„ä»¶</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>prefixCls<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$emit('click')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>button<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>çˆ¶ç»„ä»¶</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleClickButton<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">function</span> <span class="token function">handleClickButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;11111&quot;</span><span class="token punctuation">,</span> <span class="token number">11111</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ç‚¹å‡»çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸¤æ¬¡ï¼</p> <h3 id="ç»„ä»¶-v-model"><a href="#ç»„ä»¶-v-model" class="header-anchor">#</a> ç»„ä»¶ v-model</h3> <p><strong>çˆ¶ç»„ä»¶</strong></p> <blockquote><p><code>v-model:</code>+åˆ«åã€‚é»˜è®¤çš„åå­—æ˜¯<code>modelValue</code>ã€‚äº‹ä»¶åï¼š<code>update:modelValue</code></p> <p>çˆ¶ç»„ä»¶è¿™è¾¹ç»‘å®šä¸€ä¸ªå˜é‡</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ComA</span> <span class="token attr-name"><span class="token namespace">v-model:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iputText<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-model:</span>content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iputContentText<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">#box</span><span class="token punctuation">&gt;</span></span>
		slot111323232321
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ComA</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{iputText}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>{{iputContentText}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>å­ç»„ä»¶</p> <blockquote><p>å­ç»„ä»¶è¿™è¾¹<code>props</code>æ¥æ”¶åˆ«åï¼Œé€šè¿‡<code>emits</code>æŒ‡å®šè§¦å‘äº‹ä»¶å</p> <p>å¦‚æœä¸æŒ‡å®š<code>emits</code>ï¼Œå°±ä¼šæ”¶åˆ°ä¸€ä¸ªè­¦å‘Š</p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>text<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleInput<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>content<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@input</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleContentInput<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">text</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token literal-property property">content</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">emits</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;update:text&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;update:content&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> <span class="token punctuation">{</span> emit <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">handleInput</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:text&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">handleContentInput</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:content&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      handleInput<span class="token punctuation">,</span>
      handleContentInput<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="defineasynccomponent"><a href="#defineasynccomponent" class="header-anchor">#</a> defineAsyncComponent</h3> <blockquote><p>å¼‚æ­¥ç»„ä»¶è¦æ±‚ä½¿ç”¨<code>defineAsyncComponent</code> æ–¹æ³•åˆ›å»º</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineAsyncComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// ä¸å¸¦é…ç½®çš„å¼‚æ­¥ç»„ä»¶</span>
<span class="token keyword">const</span> asyncPage <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./NextPage.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœè¦é…ç½®</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> ErrorComponent <span class="token keyword">from</span> <span class="token string">&quot;./components/ErrorComponent.vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> LoadingComponent <span class="token keyword">from</span> <span class="token string">&quot;./components/LoadingComponent.vue&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// å¾…é…ç½®çš„å¼‚æ­¥ç»„ä»¶</span>
<span class="token keyword">const</span> asyncPageWithOptions <span class="token operator">=</span> <span class="token function">defineAsyncComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">loader</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./NextPage.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// component</span>
  <span class="token literal-property property">delay</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
  <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
  <span class="token literal-property property">errorComponent</span><span class="token operator">:</span> ErrorComponent<span class="token punctuation">,</span>
  <span class="token literal-property property">loadingComponent</span><span class="token operator">:</span> LoadingComponent<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æŒ‰é”®ä¿®é¥°ç¬¦"><a href="#æŒ‰é”®ä¿®é¥°ç¬¦" class="header-anchor">#</a> æŒ‰é”®ä¿®é¥°ç¬¦</h3> <blockquote><p>ä¸å†æ”¯æŒä½¿ç”¨æ•°å­— (å³é”®ç ) ä½œä¸º <code>v-on</code> ä¿®é¥°ç¬¦</p> <p>ä¸å†æ”¯æŒå…¨å±€é…ç½®çš„ <code>config.keyCodes</code></p></blockquote> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@keydown.13</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleContentInput<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> // don't work

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@keydown.enter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleContentInput<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> // ğŸ˜right
</code></pre></div><h3 id="è¿‡æ¸¡ç±»å"><a href="#è¿‡æ¸¡ç±»å" class="header-anchor">#</a> è¿‡æ¸¡ç±»å</h3> <blockquote><ul><li><code>v-enter</code> â†’ <code>v-enter-from</code></li> <li><code>v-leave</code> â†’ <code>v-leave-from</code></li></ul></blockquote> <h3 id="css"><a href="#css" class="header-anchor">#</a> css</h3> <h4 id="æ·±åº¦-ç©¿é€-é€‰æ‹©å™¨"><a href="#æ·±åº¦-ç©¿é€-é€‰æ‹©å™¨" class="header-anchor">#</a> æ·±åº¦(ç©¿é€)é€‰æ‹©å™¨</h4> <blockquote><p>åœ¨çˆ¶ç»„ä»¶ä¸­è¦†ç›–å­ç»„ä»¶çš„æ ·å¼æ—¶ï¼Œå¦‚æœçˆ¶ç»„ä»¶æ˜¯å±€éƒ¨æ ·å¼<code>(scoped)</code>ä¼šå‡ºç°æ— æ³•ä¿®æ”¹çš„æƒ…å†µã€‚è¿™æ—¶å¾—ç”¨<strong>æ›´æ·±</strong>çš„é€‰æ‹©å™¨</p> <p>ç­‰å¤§å¤šæ•°ç”¨æˆ·è¿ç§» vue3 åï¼Œå°†ä¼šå¼ƒç”¨<code>/deep/</code>ã€<code>&gt;&gt;&gt;</code>ã€‚vue3 ä¸­æ”¹ä¸º<code>:deep(cssé€‰æ‹©å™¨)</code></p></blockquote> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token punctuation">:</span><span class="token function">deep</span><span class="token punctuation">(</span>.blue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="provide-inject"><a href="#provide-inject" class="header-anchor">#</a> Provide / Inject</h3> <blockquote><p>å¦‚æœ<code>provide</code>å“åº”å¼æ•°æ®ï¼Œåˆ™åº”è¯¥ä½¿ç”¨<code>readOnly</code>åŒ…è£¹ï¼Œé¿å…æ±¡æŸ“ã€‚æ‰€æœ‰çš„æ›´æ”¹åº”è¯¥ç”±æä¾›<code>provide</code>çš„ç»„ä»¶ç»´æŠ¤ã€‚</p> <p>ä¿®æ”¹å€¼çš„æ–¹å¼ï¼š<code>provide</code>ä¸€ä¸ªä¿®æ”¹æ–¹æ³•ï¼Œåœ¨<code>Inject</code>çš„ç»„ä»¶ä¸­è°ƒç”¨æ­¤æ–¹æ³•è¿›è¡Œè¿‡ä¿®æ”¹ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// çˆ¶ç»„ä»¶</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> provide<span class="token punctuation">,</span> readonly<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">&quot;gauhar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">updateName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token function">readonly</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;updateName&quot;</span><span class="token punctuation">,</span> updateName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å­ç»„ä»¶</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token literal-property property">updateName</span><span class="token operator">:</span> any <span class="token operator">=</span> <span class="token function">inject</span><span class="token punctuation">(</span><span class="token string">&quot;updateName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">,</span>
      updateName<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h2> <h3 id="computed-debugging"><a href="#computed-debugging" class="header-anchor">#</a> Computed Debugging</h3> <blockquote><p>å¼€å‘ç¯å¢ƒä¸‹çš„<code>computed</code>è°ƒè¯•ã€‚<code>3.2æ–°å¢</code></p></blockquote> <p>æ–°å¢äº†ç¬¬äºŒä¸ªå‚æ•°</p> <ul><li><code>onTrack</code> æ”¶é›†ä¾èµ–æ—¶è§¦å‘</li> <li><code>onTrigger</code> ä¾èµ–æ”¹å˜æ—¶(æ›´æ–°æ—¶)è§¦å‘</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> plusOne <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token punctuation">.</span>value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">onTrack</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// triggered when count.value is tracked as a dependency</span>
    <span class="token keyword">debugger</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">onTrigger</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// triggered when count.value is mutated</span>
    <span class="token keyword">debugger</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// access plusOne, should trigger onTrack</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>plusOne<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// mutate count.value, should trigger onTrigger</span>
count<span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åä¿®æ”¹æ—¶é—´:</span> <span class="time">1/12/2023, 6:10:38 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/blog/reactç¬”è®°.html" class="prev">
        react
      </a></span> <span class="next"><a href="/blog/vue3æºç .html">
        vue3æºç 
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.6696418a.js" defer></script><script src="/blog/assets/js/2.dd871ef0.js" defer></script><script src="/blog/assets/js/21.5dd44e89.js" defer></script><script src="/blog/assets/js/6.e3dc3ccf.js" defer></script>
  </body>
</html>
